<!DOCTYPE HTML>
<html lang="fa-IR">
<head>
	<title>مجله حیاطمون</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/assets/images/logo.png" type="image/gif" sizes="16x16">
	<meta charset="UTF-8">


	<!-- Font -->

	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


	<!-- Stylesheets -->

	<link rel="stylesheet" href="/assets/cdn/WebFonts/css/fontiran.css">
	<link href="/blog/common-css/bootstrap.css" rel="stylesheet">
	<link href="/blog/common-css/ionicons.css" rel="stylesheet">
	<link href="/blog/blog-sidebar/css/styles.css" rel="stylesheet">
	<link href="/blog/blog-sidebar/css/responsive.css" rel="stylesheet">

	<script>
		/**
		 * @param {String} HTML representing a single element
		 * @return {Element}
		 */
		function htmlToElement(html) {
			var template = document.createElement('template');
			html = html.trim(); // Never return a text node of whitespace as the result
			template.innerHTML = html;
			return template.content.firstChild;
		}
	</script>

<template id="template.post">
	<div class="col-md-6 col-sm-12">
		<div class="card h-100">
			<div class="single-post post-style-1">
				<div class="blog-image"><img src="{cover}" alt="عکس پست"></div>

				<a class="avatar" href="{link}"><img src="/blog/images/icons8-team-355979.jpg" alt="Profile Image"></a>

				<div class="blog-info">

					<h4 class="title"><a href="{link}"><b>{title}</b></a></h4>

					<ul class="post-footer">
						<li><a href="javascript:void(0)"><i class="ion-eye"></i>{view}</a></li>
						<li><a href="javascript:void(0)"><i class="ion-heart"></i>{like}</a></li>
						<!-- <li><a href="#"><i class="ion-chatbubble"></i>6</a></li> -->
					</ul>

				</div><!-- blog-info -->
			</div><!-- single-post -->
		</div><!-- card -->
	</div><!-- col-md-6 col-sm-12 -->
</template>

<script>
	function addPost(data) {
		let ws = document.getElementById('workspace')
		let template = document.getElementById('template.post').innerHTML.trim()
		for(let key in data) {
			template = template.split(`{${key}}`).join(data[key])
		}
		let post = htmlToElement(template)
		ws.appendChild(post)
	}
</script>

</head>
<body >
	<div class="loading">
		<img src="/assets/images/loading.gif" alt="">
	</div>
	<div class="slider display-table center-text">
		<h1 class="title display-table-cell"><b>مجله حیاطمون</b></h1>
	</div><!-- slider -->

	<section class="blog-area section">
		<div class="container">

			<div class="row">


				<div class="col-lg-4 col-md-12 ">

					<div class="single-post info-area ">

						<div class="about-area newest">
							<h4 class="title"><b>جدیدترین  مطالب</b></h4>
							<ul>
	<!-- 							<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a> -->
							</ul>
						</div>

						<div class="about-area popust" style="border: none">
							<h4 class="title"><b>محبوب ترین مقالات</b></h4>
							<ul>
					<!-- 			<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a>
								<a href=""><li><i class="ion-android-apps"></i>عنوان</li></a> -->
							</ul>
						</div>


					</div><!-- info-area -->

				</div><!-- col-lg-4 col-md-12 -->

				<div class="col-lg-8 col-md-8">
					<div class="row" id="workspace">

						
						<!-- inject here -->
						
					</div><!-- row -->

					<a id="more" class="load-more-btn" href="javascript:void(0)"><b>بیشتر</b></a>

				</div><!-- col-lg-8 col-md-12 -->



			</div><!-- row -->

		</div><!-- container -->
	</section><!-- section -->


	<footer>
		<div class="container">
			<div class="row">

				<div class="col-md-12">
					<div class="footer-section">
						<a class="logo" href="/"><img src="/blog/images/logo.png" alt="Hayatemoon"></a>
						<!-- <a class="logo" href="#"><img src="/blog/images/logo.png" alt="Logo Image"></a> -->
						<p class="copyright">تمام حقوق این اثر مطعلق به حیاطمون میباشد.</p>
						<!-- <p class="copyright">Designed by <a href="https://colorlib.com" target="_blank">Colorlib</a></p> -->
						<ul class="icons">
							<li><a href="http://facebook.com/hayatemooon"><i class="ion-social-facebook-outline"></i></a></li>
							<li><a href="http://twitter.com/hayatemoon"><i class="ion-social-twitter-outline"></i></a></li>
							<li><a href="http://instagram.com/hayatemoon"><i class="ion-social-instagram-outline"></i></a></li>
						</ul>

					</div><!-- footer-section -->
				</div><!-- col-md-12 -->

			</div><!-- row -->
		</div><!-- container -->
	</footer>


	<!-- SCRIPTS -->

	<script src="/blog/common-js/jquery-3.1.1.min.js"></script>

	<script src="/blog/common-js/tether.min.js"></script>

	<script src="/blog/common-js/bootstrap.js"></script>

	<script src="/blog/common-js/scripts.js"></script>

	<script src="/script/api.js"></script>

	<script>
		(async function() {			
			var _start = 0;
			var _limit = 10;
			var _all = await strapi.post.count();
			function more() {
				_start += _limit
				start()
			}
			function start() {
				strapi.post.find({_start, _limit}).then(posts => {
					for(let post of posts) {
						addPost({
							id: post.id,
							title: post.title,
							cover: post.cover.url,
							link: `/blog/post.html?id=${post.id}`,
							like: (post.like == "" || post.like == null) ? 0 : post.like,
							view: (post.view == "" || post.view == null) ? 0 : post.view,
						})
					}
					if(_all <= _limit + _start) {
						start = e => e
						more = e => e
						document.getElementById("more").hidden = true
					}
				})
			}
			$('#more').click(more);
			document.addEventListener("DOMContentLoaded", start)
			strapi.post.find({
				_sort: 'like:desc',
				_limit: 10
			}).then(posts=> {
				$('.popust ul').html('');
				posts.forEach(function(post) {
					$('.popust ul').append(`
						<a href="/blog/post.html?id=${post.id}"><li><img src='${post.cover.url}'><span>${post.title}</span></li></a>
					`);
				});
			});
			strapi.post.find({
				_sort: 'created_at:desc',
				_limit: 10
			}).then(posts=> {
				$('.newest ul').html('');
				posts.forEach(function(post) {
					$('.newest ul').append(`
						<a href="/blog/post.html?id=${post.id}"><li><img src='${post.cover.url}'><span>${post.title}</span></li></a>
					`);
				});
			});
			$('.loading').fadeOut(300);
		})()
	</script>
</body>
</html>
